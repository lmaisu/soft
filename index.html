<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlayStation Zone Management</title>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #000;
            color: #fff;
            padding: 20px;
            margin: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #444;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #121212;
            color: #ff914d;
        }

        input, select {
            width: 100%;
            padding: 5px;
            background-color: #222;
            color: #fff;
            border: 1px solid #444;
            border-radius: 5px;
            font-size: 14px;
        }

        button {
            background-color: #ff914d;
            color: #000;
            font-weight: bold;
            border: none;
            padding: 10px;
            cursor: pointer;
            margin-top: 10px;
        }

        .status-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-green {
            background-color: #00ff00;
        }

        .status-red {
            background-color: #ff0000;
        }

        .blinking {
            animation: blink 1s infinite;
        }

        .time-red {
            color: #ff0000;
        }

        @keyframes blink {
            50% {
                background-color: #ff914d;
            }
        }
    </style>
</head>
<body>
    <h1>PlayStation Zone Management</h1>
    <table>
        <thead>
            <tr>
                <th>PlayStation</th>
                <th>Start Time</th>
                <th>Duration</th>
                <th>Controllers</th>
                <th>Slushies</th>
                <th>Total Price</th>
                <th>Payment</th>
                <th>Time Left</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="psTable">
            <!-- Dynamic rows will be added here -->
        </tbody>
    </table>
    <button onclick="addRow()">Add Entry</button>

    <script>
        let countdownIntervals = [];

        function addRow() {
            const table = document.getElementById('psTable');

            const row = document.createElement('tr');

            // PlayStation Selection
            const psCell = document.createElement('td');
            psCell.innerHTML = `
                <select>
                    <option value="Basic1">Basic 1</option>
                    <option value="Basic2">Basic 2</option>
                    <option value="VIP1">VIP Room I</option>
                    <option value="VIP2">VIP Room II</option>
                </select>
            `;
            row.appendChild(psCell);

            // Start Time
            const startCell = document.createElement('td');
            const now = new Date();
            now.setMinutes(now.getMinutes() + 3);
            const startTime = now.toLocaleTimeString("en-GB", { hour: '2-digit', minute: '2-digit' });
            startCell.innerHTML = `<input type="text" value="${startTime}" readonly>`;
            row.appendChild(startCell);

            // Duration
            const durationCell = document.createElement('td');
            durationCell.innerHTML = `
                <select onchange="updatePrice(this)">
                    <option value="30">30 Minutes</option>
                    <option value="60">1 Hour</option>
                    <option value="90">1 Hour 30 Minutes</option>
                    <option value="120">2 Hours</option>
                    <option value="150">2 Hours 30 Minutes</option>
                    <option value="180">3 Hours</option>
                    <option value="240">4 Hours</option>
                    <option value="300">5 Hours</option>
                    <option value="360">6 Hours</option>
                </select>
                <input type="number" placeholder="Custom (Minutes)" min="1" onchange="updatePrice(this)">
            `;
            row.appendChild(durationCell);

            // Controllers
            const controllersCell = document.createElement('td');
            controllersCell.innerHTML = `
                <select onchange="updatePrice(this)">
                    <option value="2">2 Controllers</option>
                    <option value="4">4 Controllers</option>
                </select>
            `;
            row.appendChild(controllersCell);

            // Slushies
            const slushiesCell = document.createElement('td');
            slushiesCell.innerHTML = `<input type="number" value="0" min="0" onchange="updatePrice(this)">`;
            row.appendChild(slushiesCell);

            // Total Price
            const priceCell = document.createElement('td');
            priceCell.innerHTML = `<span>0₾</span>`;
            row.appendChild(priceCell);

            // Payment Method
            const paymentCell = document.createElement('td');
            paymentCell.innerHTML = `
                <select onchange="updateStatus(this)">
                    <option value="not-paid">Not Paid</option>
                    <option value="cash">Cash</option>
                    <option value="bog">BOG</option>
                    <option value="tbc">TBC</option>
                </select>
            `;
            row.appendChild(paymentCell);

            // Time Left
            const timerCell = document.createElement('td');
            timerCell.innerHTML = `<span>--:--:--</span>`;
            row.appendChild(timerCell);

            // Status
            const statusCell = document.createElement('td');
            statusCell.innerHTML = `<span class="status-indicator status-red"></span>`;
            row.appendChild(statusCell);

            table.appendChild(row);

            // Start the countdown for this row
            const intervalId = setInterval(() => updateTimer(row), 1000);
            countdownIntervals.push(intervalId);
        }

        function updatePrice(element) {
            const row = element.closest('tr');
            const durationSelect = row.cells[2].querySelector('select');
            const durationInput = row.cells[2].querySelector('input');
            const duration = parseInt(durationInput.value || durationSelect.value) || 0;
            const controllers = parseInt(row.cells[3].querySelector('select').value) || 2;
            const slushies = parseInt(row.cells[4].querySelector('input').value) || 0;

            // Base price calculations
            const baseRate = controllers === 2 ? 8 : 12; // 8₾ for 2 controllers, 12₾ for 4
            const totalBasePrice = (baseRate / 60) * duration; // Calculate price based on duration
            const extraSlushiePrice = slushies > (duration >= 120 ? 2 : 0) ? (slushies - (duration >= 120 ? 2 : 0)) * 3.5 : 0;

            const totalPrice = totalBasePrice + extraSlushiePrice;

            // Update the price cell
            row.cells[5].querySelector('span').innerText = `${totalPrice.toFixed(2)}₾`;
        }

        function updateStatus(select) {
            const row = select.closest('tr');
            const statusIndicator = row.cells[8].querySelector('.status-indicator');
            if (select.value !== 'not-paid') {
                statusIndicator.classList.remove('status-red');
                statusIndicator.classList.add('status-green');
            } else {
                statusIndicator.classList.remove('status-green');
                statusIndicator.classList.add('status-red');
            }
        }

        function updateTimer(row) {
            const startTime = new Date();
            const durationSelect = row.cells[2].querySelector('select');
            const durationInput = row.cells[2].querySelector('input');
            const duration = parseInt(durationInput.value || durationSelect.value) || 0;
            const endTime = new Date(startTime.getTime() + duration * 60000);

            const now = new Date();
            const remainingTime = Math.max(0, endTime - now);

            const timerCell = row.cells[7].querySelector('span');
            if (remainingTime > 0) {
                const hours = Math.floor(remainingTime / 3600000);
                const minutes = Math.floor((remainingTime % 3600000) / 60000);
                const seconds = Math.floor((remainingTime % 60000) / 1000);
                timerCell.innerText = `${hours}:${minutes < 10 ? '0' : ''}${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            } else {
                timerCell.innerText = "Time's Up!";
                timerCell.classList.add('time-red');
                row.classList.add('blinking');
            }
        }
    </script>
</body>
</html>
